
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestión de Auditorio</title>
  <meta name="description" content="Sistema de gestión de asientos para auditorios">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  
  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="stylr.css">
</head>
<body>
  <!-- Cabecera -->
  <header class="bg-auditorio-rojo py-4 px-3 shadow-sm">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-12 col-sm-8 mb-2 mb-sm-0">
          <h1 class="text-white fw-bold mb-0 fs-3">Gestión de Auditorio</h1>
        </div>
        <div class="col-12 col-sm-4 text-sm-end">
          <span class="text-white opacity-75 small">Sistema de administración de asientos</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Contenido principal -->
  <main class="container py-4">
    <!-- Botón para mostrar/ocultar formulario en móvil -->
    <div class="d-md-none mb-3">
      <button id="toggleFormBtn" class="btn btn-auditorio-rojo w-100">
        Mostrar menú
      </button>
    </div>

    <div class="row g-4">
      <!-- Sidebar con formularios -->
      <aside id="sidebar" class="col-12 col-md-4 col-lg-3 d-none d-md-block">
        <div class="mb-4">
          <!-- Formulario para crear eventos -->
          <div class="card shadow-sm mb-4">
            <div class="card-header bg-white">
              <h5 class="card-title text-auditorio-rojo mb-0">Crear Nuevo Evento</h5>
            </div>
            <div class="card-body">
              <form id="eventoForm">
                <div class="mb-3">
                  <label for="nombreEvento" class="form-label">Nombre del evento</label>
                  <input type="text" class="form-control" id="nombreEvento" required placeholder="Ingrese el nombre del evento">
                </div>
                <div class="mb-3">
                  <label for="fechaEvento" class="form-label">Fecha</label>
                  <input type="date" class="form-control" id="fechaEvento" required>
                </div>
                <div class="mb-3">
                  <label for="horaEvento" class="form-label">Hora</label>
                  <input type="time" class="form-control" id="horaEvento" required>
                <div class="mb-3">
                  <label for="descripcionEvento" class="form-label">Descripción</label>
                  <textarea class="form-control" id="descripcionEvento" rows="3" placeholder="Descripción del evento"></textarea>
                </div>
                <button type="submit" id="crearEventoBtn" class="btn btn-auditorio-rojo w-100">Crear Evento</button>
              </form>
            </div>
          </div>

          <!-- Selector de eventos -->
          <div class="card shadow-sm mb-4">
            <div class="card-header bg-white">
              <h5 class="card-title text-auditorio-rojo mb-0">Seleccionar Evento</h5>
            </div>
            <div class="card-body">
              <div id="listaEventos" class="d-grid gap-2">
                <!-- Los eventos se cargarán dinámicamente aquí -->
                <div id="eventosCargando" class="text-center py-3">
                  <div class="spinner-border text-auditorio-rojo spinner-border-sm" role="status">
                    <span class="visually-hidden">Cargando...</span>
                  </div>
                  <span class="ms-2">Cargando eventos...</span>
                </div>
                <div id="eventosVacio" class="text-center py-3 d-none">
                  No hay eventos disponibles. Crea un evento nuevo para comenzar.
                </div>
              </div>
            </div>
          </div>

          <!-- Estadísticas del evento -->
          <div id="estadisticasContainer" class="card shadow-sm d-none">
            <div class="card-header bg-white">
              <h5 class="card-title text-auditorio-rojo mb-0">Estadísticas del Evento</h5>
            </div>
            <div class="card-body">
              <div class="mb-3 d-flex justify-content-between align-items-center">
                <span>Asientos Totales:</span>
                <span id="totalAsientos" class="fw-bold">0</span>
              </div>
              
              <div class="mb-3">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <span class="text-success">Disponibles:</span>
                  <span id="asientosDisponibles" class="fw-bold">0 (0%)</span>
                </div>
                <div class="progress" style="height: 10px;">
                  <div id="barraDisponibles" class="progress-bar bg-success" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
              </div>
              
              <div class="mb-3">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <span class="text-warning">Reservados:</span>
                  <span id="asientosReservados" class="fw-bold">0 (0%)</span>
                </div>
                <div class="progress" style="height: 10px;">
                  <div id="barraReservados" class="progress-bar bg-warning" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
              </div>
              
              <div>
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <span class="text-danger">Ocupados:</span>
                  <span id="asientosOcupados" class="fw-bold">0 (0%)</span>
                </div>
                <div class="progress" style="height: 10px;">
                  <div id="barraOcupados" class="progress-bar bg-auditorio-rojo" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </aside>
      
      <!-- Área principal con secciones de auditorio -->
      <div id="mainContent" class="col-12 col-md-8 col-lg-9">
        <!-- Contenido del evento seleccionado -->
        <div id="eventoSeleccionado" class="d-none">
          <div class="mb-4">
            <h2 id="nombreEventoSeleccionado" class="h3 text-auditorio-rojo fw-bold mb-2"></h2>
            <p id="fechaEventoSeleccionado" class="text-muted"></p>
            <p id="descripcionEventoSeleccionado" class="mb-0 mt-2"></p>
          </div>
          
          <!-- Leyenda de asientos -->
          <div class="mb-4 bg-light p-3 rounded d-flex flex-wrap justify-content-center gap-3">
            <div class="d-flex align-items-center">
              <div class="bg-auditorio-verde square-legend me-2"></div>
              <span>Disponible</span>
            </div>
            <div class="d-flex align-items-center">
              <div class="bg-auditorio-amarillo square-legend me-2"></div>
              <span>Reservado</span>
            </div>
            <div class="d-flex align-items-center">
              <div class="bg-auditorio-rojo square-legend me-2"></div>
              <span>Ocupado</span>
            </div>
          </div>
          
          <!-- Notificación de asientos seleccionados -->
          <div id="asientosSeleccionadosAlert" class="alert alert-primary d-flex justify-content-between align-items-center d-none" role="alert">
            <span id="cantidadSeleccionados">0 asiento(s) seleccionado(s)</span>
            <div>
              <button id="editarSeleccionadosBtn" class="btn btn-sm btn-auditorio-rojo me-2">Editar estado</button>
              <button id="limpiarSeleccionBtn" class="btn btn-sm btn-outline-secondary">Limpiar selección</button>
            </div>
          </div>
          
          <!-- Cargando asientos -->
          <div id="asientosCargando" class="text-center py-5">
            <div class="spinner-border text-auditorio-rojo" role="status">
              <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-3">Cargando asientos...</p>
          </div>
          
          <!-- Secciones del auditorio -->
          <div id="seccionesAuditorio" class="row g-4 d-none">
            <!-- Sección 1 -->
            <div class="col-12 col-lg-6">
              <div class="border rounded p-3">
                <h3 class="h5 text-auditorio-rojo fw-semibold mb-3">Sección 1</h3>
                
                <div class="text-center mb-3">
                  <div class="bg-light d-inline-block px-4 py-2 rounded">Escenario</div>
                </div>
                
                <div class="overflow-auto">
                  <div id="seccion1" class="d-flex flex-column align-items-center">
                    <!-- Los asientos se cargarán dinámicamente aquí -->
                  </div>
                </div>
                
                <div class="d-flex justify-content-center mt-3">
                  <div class="d-flex gap-3">
                    <span class="text-center fw-medium" style="width: 24px;">1</span>
                    <span class="text-center fw-medium" style="width: 24px;">2</span>
                    <span class="text-center fw-medium" style="width: 24px;">3</span>
                    <span class="text-center fw-medium" style="width: 24px;">4</span>
                    <span class="text-center fw-medium" style="width: 24px;">5</span>
                    <span class="text-center fw-medium" style="width: 24px;">6</span>
                    <span class="text-center fw-medium" style="width: 24px;">7</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Sección 2 -->
            <div class="col-12 col-lg-6">
              <div class="border rounded p-3">
                <h3 class="h5 text-auditorio-rojo fw-semibold mb-3">Sección 2</h3>
                
                <div class="text-center mb-3">
                  <div class="bg-light d-inline-block px-4 py-2 rounded">Escenario</div>
                </div>
                
                <div class="overflow-auto">
                  <div id="seccion2" class="d-flex flex-column align-items-center">
                    <!-- Los asientos se cargarán dinámicamente aquí -->
                  </div>
                </div>
                
                <div class="d-flex justify-content-center mt-3">
                  <div class="d-flex gap-3">
                    <span class="text-center fw-medium" style="width: 24px;">1</span>
                    <span class="text-center fw-medium" style="width: 24px;">2</span>
                    <span class="text-center fw-medium" style="width: 24px;">3</span>
                    <span class="text-center fw-medium" style="width: 24px;">4</span>
                    <span class="text-center fw-medium" style="width: 24px;">5</span>
                    <span class="text-center fw-medium" style="width: 24px;">6</span>
                    <span class="text-center fw-medium" style="width: 24px;">7</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Mensaje de bienvenida -->
        <div id="bienvenida" class="text-center py-5">
          <h2 class="h4 fw-medium mb-3">Bienvenido al Sistema de Gestión de Auditorio</h2>
          <p class="text-muted mb-4">Por favor, crea un nuevo evento o selecciona uno existente para comenzar.</p>
          <div class="d-flex justify-content-center">
            <div class="bg-auditorio-rojo rounded-circle p-2 animate__animated animate__bounce animate__infinite">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="white">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Pie de página -->
  <footer class="bg-dark text-white py-3 mt-auto">
    <div class="container text-center">
      <p class="small mb-0">&copy; <span id="currentYear"></span> - Sistema de Gestión de Auditorio</p>
    </div>
  </footer>

  <!-- Modal para editar asientos -->
  <div class="modal fade" id="asientoModal" tabindex="-1" aria-labelledby="asientoModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="asientoModalLabel">Detalles de Asiento</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="asientoDetalles">
            <!-- Los detalles del asiento se cargarán dinámicamente aquí -->
          </div>
        </div>
        <div class="modal-footer d-flex justify-content-between">
          <button type="button" id="btnDisponible" class="btn btn-success">Marcar como Disponible</button>
          <button type="button" id="btnReservado" class="btn btn-warning text-dark">Marcar como Reservado</button>
          <button type="button" id="btnOcupado" class="btn btn-auditorio-rojo">Marcar como Ocupado</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast para notificaciones -->
  <div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header">
        <strong id="toastTitulo" class="me-auto"></strong>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
      <div id="toastMensaje" class="toast-body">
      </div>
    </div>
  </div>

  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <!-- JavaScript personalizado -->
  <script src="js/prueba.js"></script>
  <script src="js/tipos.js"></script>
  <script src="js/supabaseClients.js"></script>
  <script src="js/app.js"></script>
</body>
</html>